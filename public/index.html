<html>
	<head>
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
		<script src="js/socket.io.js"></script>
		<script src="js/live-graph.js"></script>
		<script src="http://cdnjs.cloudflare.com/ajax/libs/d3/2.8.1/d3.v2.min.js" type="text/javascript"></script>
		<link rel="stylesheet" href="http://twitter.github.com/bootstrap/assets/css/bootstrap.css" type="text/css" />
		<script>
		
		  var ON = true;
		  var OFF = false;
		  var socket, graph, timeout;
		  
		  var resetTimer = function() {
		  	clearTimeout(timeout);
		  	timeout = setTimeout(function(){
		  		setStatus(false);
		  	}, 10000);
		  };
		  
		  var setStatus = function(status) {
		  	if(status == ON){
		  		$("h4.stream-status span").attr("class","badge badge-info").html("LIVE");
		  	}
		  	else if(status == OFF){
		  		$("h4.stream-status span").attr("class","badge").html("OFFLINE");
		  	}
		  };
		  
		  $(document).ready(function() {
		  	setStatus(OFF);
		  	socket = io.connect('http://live.ollie.ws:8080');
		  	edaGraph = new Graph({ el:"#eda", pad:125, size:600};);
		  	xGraph = new Graph({ el:"#accx", pad:125, size:600, label:"X"};);
		  	$("div.loading").fadeOut();
		  	socket.on('packet', function (data) {
		  		setStatus(true);
		  		resetTimer();
		    	var line = data.payload.replace("\r\n","").split(",");
		    	edaGraph.addPoint(parseFloat( line[line.length-1] ));
		    	xGraph.addPoint(parseFloat( line[3] ));
		 	});
		 	
		 	
		 });
		</script>
		<link rel="stylesheet" href="stylesheets/graph.css" type="text/css" />
	</head>
	<body>
		<div class="container-fluid">
			<div class="page-header">
				<div class="row-fluid">
					<div class="span10"><h1>OliverWS</h1></div>
					<div class="span2 pull-right"><h4 class="stream-status">Stream is <span class="badge">OFF</span></h4></div>
				</div>
			</div>
		
			<div class="row-fluid">
				<div class="span12">
					<div class="loading" style="
					    width: 33%;
					    left: 33%;
					    top: 33%;
					    position: absolute;
					">
						<h2>Loading...</h2>
						<div class="progress progress-striped active">
						  <div class="bar" style="width: 100%;"></div>
						</div>
					</div>
					<div id="eda" style="width: 100%; height:50%;"></div>
					<div id="accx" style="width: 100%; height:10%;"></div>
					
				</div>
			</div>
		</div>
		
	
	
	
	</body>
</html>